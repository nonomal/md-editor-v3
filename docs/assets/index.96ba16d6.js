import{s as K,v as ue,x as ve,P as c,d as z,h as H,r as re,m as U,w as M,i as J,y as ae,z as de,A as W,B as R,_ as D,b as x,C as V,R as he,D as q,E as Q,G as ge,p as pe,l as me,q as ie,j as oe,H as xe,I as Ce,J as ke,K as ye}from"./index.5b5b3d1c.js";import{o as Te}from"./index.9563d230.js";function F(n){return n!==window?n.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function X(n,e,t){if(t!==void 0&&e.top>n.top-t)return"".concat(t+e.top,"px")}function Y(n,e,t){if(t!==void 0&&e.bottom<n.bottom+t){var r=window.innerHeight-e.bottom;return"".concat(t+r,"px")}}var le=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],_=[];function Z(n,e){if(!!n){var t=_.find(function(r){return r.target===n});t?t.affixList.push(e):(t={target:n,affixList:[e],eventHandlers:{}},_.push(t),le.forEach(function(r){t.eventHandlers[r]=K(n,r,function(){t.affixList.forEach(function(d){var p=d.exposed.lazyUpdatePosition;p()},(r==="touchstart"||r==="touchmove")&&ue?{passive:!0}:!1)})}))}}function ee(n){var e=_.find(function(t){var r=t.affixList.some(function(d){return d===n});return r&&(t.affixList=t.affixList.filter(function(d){return d!==n})),r});e&&e.affixList.length===0&&(_=_.filter(function(t){return t!==e}),le.forEach(function(t){var r=e.eventHandlers[t];r&&r.remove&&r.remove()}))}function we(){return typeof window!="undefined"?window:null}var O;(function(n){n[n.None=0]="None",n[n.Prepare=1]="Prepare"})(O||(O={}));var Le={offsetTop:c.number,offset:c.number,offsetBottom:c.number,target:c.func.def(we),prefixCls:c.string,onChange:c.func,onTestUpdatePosition:c.func},Ae=z({name:"AAffix",props:Le,emits:["change","testUpdatePosition"],setup:function(e,t){var r=t.slots,d=t.emit,p=t.expose,T=H(),m=H(),l=re({affixStyle:void 0,placeholderStyle:void 0,status:O.None,lastAffix:!1,prevTarget:null,timeout:null}),k=ge(),w=U(function(){return e.offsetBottom===void 0&&e.offsetTop===void 0?0:e.offsetTop}),E=U(function(){return e.offsetBottom}),N=function(){var v=l.status,L=l.lastAffix,o=e.target;if(!(v!==O.Prepare||!m.value||!T.value||!o)){var a=o();if(!!a){var i={status:O.None},g=F(a),s=F(T.value),I=X(s,g,w.value),y=Y(s,g,E.value);I!==void 0?(i.affixStyle={position:"fixed",top:I,width:s.width+"px",height:s.height+"px"},i.placeholderStyle={width:s.width+"px",height:s.height+"px"}):y!==void 0&&(i.affixStyle={position:"fixed",bottom:y,width:s.width+"px",height:s.height+"px"},i.placeholderStyle={width:s.width+"px",height:s.height+"px"}),i.lastAffix=!!i.affixStyle,L!==i.lastAffix&&d("change",i.lastAffix),q(l,i)}}},f=function(){q(l,{status:O.Prepare,affixStyle:void 0,placeholderStyle:void 0}),k.update()},h=Q(function(){f()}),C=Q(function(){var u=e.target,v=l.affixStyle;if(u&&v){var L=u();if(L&&T.value){var o=F(L),a=F(T.value),i=X(a,o,w.value),g=Y(a,o,E.value);if(i!==void 0&&v.top===i||g!==void 0&&v.bottom===g)return}}f()});p({updatePosition:h,lazyUpdatePosition:C}),M(function(){return e.target},function(u){var v=null;u&&(v=u()||null),l.prevTarget!==v&&(ee(k),v&&(Z(v,k),h()),l.prevTarget=v)}),M(function(){return[e.offsetTop,e.offsetBottom]},h),J(function(){var u=e.target;u&&(l.timeout=setTimeout(function(){Z(u(),k),h()}))}),ae(function(){N()}),de(function(){clearTimeout(l.timeout),ee(k),h.cancel(),C.cancel()});var S=W("affix",e),b=S.prefixCls;return function(){var u,v=l.affixStyle,L=l.placeholderStyle,o=R(D({},b.value,v)),a=Te(e,["prefixCls","offsetTop","offsetBottom","target"]);return x(he,{onResize:h},{default:function(){return[x("div",V(V({},a),{},{style:L,ref:T}),[x("div",{class:o,ref:m,style:v},[(u=r.default)===null||u===void 0?void 0:u.call(r)])])]}})}}}),be=ve(Ae);function $(){}var fe=Symbol("anchorContextKey"),Ie=function(e){pe(fe,e)},Se=function(){return me(fe,{registerLink:$,unregisterLink:$,scrollTo:$,activeLink:U(function(){return""}),handleClick:$})},Pe=Ie;function se(){return window}function te(n,e){if(!n.getClientRects().length)return 0;var t=n.getBoundingClientRect();return t.width||t.height?e===window?(e=n.ownerDocument.documentElement,t.top-e.clientTop):t.top-e.getBoundingClientRect().top:t.top}var ne=/#(\S+)$/,Ee={prefixCls:c.string,offsetTop:c.number,bounds:c.number,affix:c.looseBool.def(!0),showInkInFixed:c.looseBool.def(!1),getContainer:c.func.def(se),wrapperClass:c.string,wrapperStyle:c.style,getCurrentAnchor:c.func,targetOffset:c.number,onChange:c.func,onClick:c.func},P=z({name:"AAnchor",inheritAttrs:!1,props:Ee,emits:["change","click"],setup:function(e,t){var r=t.emit,d=t.attrs,p=t.slots,T=t.expose,m=W("anchor",e),l=m.prefixCls,k=m.getTargetContainer,w=m.direction,E=H(),N=H(),f=re({links:[],scrollContainer:null,scrollEvent:null,animating:!1}),h=H(null),C=U(function(){var o=e.getContainer;return o||k.value||se}),S=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,g=[],s=C.value();if(f.links.forEach(function(y){var A=ne.exec(y.toString());if(!!A){var B=document.getElementById(A[1]);if(B){var j=te(B,s);j<a+i&&g.push({link:y,top:j})}}}),g.length){var I=g.reduce(function(y,A){return A.top>y.top?A:y});return I.link}return""},b=function(a){var i=e.getCurrentAnchor;h.value!==a&&(h.value=typeof i=="function"?i():a,r("change",a))},u=function(a){var i=e.offsetTop,g=e.getContainer,s=e.targetOffset;b(a);var I=g(),y=xe(I,!0),A=ne.exec(a);if(!!A){var B=document.getElementById(A[1]);if(!!B){var j=te(B,I),G=y+j;G-=s!==void 0?s:i||0,f.animating=!0,Ce(G,{callback:function(){f.animating=!1},getContainer:g})}}};T({scrollTo:u});var v=function(){if(!f.animating){var a=e.offsetTop,i=e.bounds,g=e.targetOffset,s=S(g!==void 0?g:a||0,i);b(s)}},L=function(){var a=N.value.getElementsByClassName("".concat(l.value,"-link-title-active"))[0];a&&(E.value.style.top="".concat(a.offsetTop+a.clientHeight/2-4.5,"px"))};return Pe({registerLink:function(a){f.links.includes(a)||f.links.push(a)},unregisterLink:function(a){var i=f.links.indexOf(a);i!==-1&&f.links.splice(i,1)},activeLink:h,scrollTo:u,handleClick:function(a,i){r("click",a,i)}}),J(function(){ie(function(){var o=C.value();f.scrollContainer=o,f.scrollEvent=K(f.scrollContainer,"scroll",v),v()})}),oe(function(){f.scrollEvent&&f.scrollEvent.remove()}),ae(function(){if(f.scrollEvent){var o=C.value();f.scrollContainer!==o&&(f.scrollContainer=o,f.scrollEvent.remove(),f.scrollEvent=K(f.scrollContainer,"scroll",v),v())}L()}),function(){var o,a=e.offsetTop,i=e.affix,g=e.showInkInFixed,s=l.value,I=R("".concat(s,"-ink-ball"),{visible:h.value}),y=R(e.wrapperClass,"".concat(s,"-wrapper"),D({},"".concat(s,"-rtl"),w.value==="rtl")),A=R(s,{fixed:!i&&!g}),B=q({maxHeight:a?"calc(100vh - ".concat(a,"px)"):"100vh"},e.wrapperStyle),j=x("div",{class:y,style:B,ref:N},[x("div",{class:A},[x("div",{class:"".concat(s,"-ink")},[x("span",{class:I,ref:E},null)]),(o=p.default)===null||o===void 0?void 0:o.call(p)])]);return i?x(be,V(V({},d),{},{offsetTop:a,target:C.value}),{default:function(){return[j]}}):j}}}),Be={prefixCls:c.string,href:c.string.def("#"),title:c.VNodeChild,target:c.string},je=z({name:"AAnchorLink",props:Be,slots:["title"],setup:function(e,t){var r=t.slots,d=null,p=Se(),T=p.handleClick,m=p.scrollTo,l=p.unregisterLink,k=p.registerLink,w=p.activeLink,E=W("anchor",e),N=E.prefixCls,f=function(C){var S=e.href;T(C,{title:d,href:S}),m(S)};return M(function(){return e.href},function(h,C){ie(function(){l(C),k(h)})}),J(function(){k(e.href)}),oe(function(){l(e.href)}),function(){var h,C=e.href,S=e.target,b=N.value,u=ke(r,e,"title");d=u;var v=w.value===C,L=R("".concat(b,"-link"),D({},"".concat(b,"-link-active"),v)),o=R("".concat(b,"-link-title"),D({},"".concat(b,"-link-title-active"),v));return x("div",{class:L},[x("a",{class:o,href:C,title:typeof u=="string"?u:"",target:S,onClick:f},[u]),(h=r.default)===null||h===void 0?void 0:h.call(r)])}}});P.Link=je;P.install=function(n){return n.component(P.name,P),n.component(P.Link.name,P.Link),n};const Ne=(n,e=100)=>{let t=-1;return()=>{clearTimeout(t),t=setTimeout(n,e)}},{Link:Oe}=P,ce=z({props:{tocItem:{type:Object,default:()=>({})}},setup(n){return()=>{const{tocItem:e}=n;return x(Oe,{href:`#${e.text}`,title:e.text},{default:()=>[e.children&&x("div",{class:"catalog-container"},[e.children.map(t=>x(ce,{key:`${t.level}-${t.text}`,tocItem:t},null))])]})}}});function Re(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!ye(n)}const He=z({props:{heads:{type:Array}},setup(n){const e=U(()=>{var d;const r=[];return(d=n.heads)==null||d.forEach(({text:p,level:T})=>{const m={level:T,text:p};if(r.length===0)r.push(m);else{let l=r[r.length-1];if(m.level>l.level)for(let k=l.level+1;k<=6;k++){const{children:w}=l;if(!w){l.children=[m];break}if(l=w[w.length-1],m.level<=l.level){w.push(m);break}}else r.push(m)}}),r}),t=Ne(()=>{const r=decodeURIComponent(location.hash).replace("#","");if(r){const d=document.getElementById(r);if(d){const p=d.offsetTop+414;window.scrollTo({top:p,behavior:"smooth"})}}});return M(()=>n.heads,t),()=>{let r;return x(P,{affix:!1,showInkInFixed:!1},Re(r=e.value.map(d=>x(ce,{key:d.text,tocItem:d},null)))?r:{default:()=>[r]})}}});var Fe=He;export{be as A,Fe as C};
